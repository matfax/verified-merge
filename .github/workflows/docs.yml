name: docs

on:
  push:
    branches:
      - main
    paths:
      - '**.md'
      - '**.tpl'
      - '**/docs.yml'
      - '**/action.yml'
  pull_request:
    branches:
      - main

jobs:
  update-docs:
    name: Update action documentation
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # v4.2.2
        
      - name: Update action documentation
        uses: GLB-BDS-SF/action-docs@4be865bd0a1f9e7cd4c63acd1fc0494bc9f66458 # latest
        with:
          action_docs_git_push: false
          action_docs_template_file: ./.github/action.tpl
          
      - name: Create pull request
        uses: peter-evans/create-pull-request@271a8d0340265f705b14b6d32b9829c1cb33d45e # v7.0.8
        with:
          commit-message: 'docs: auto-update action documentation'
          title: 'docs: Update action documentation'
          body: |
            This pull request automatically updates the action documentation based on changes to action.yml.
            
            Generated by the docs workflow.
          branch: update-action-docs
          delete-branch: true
          sign-commits: true
